(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[810],{3304:(e,t,s)=>{"use strict";s.d(t,{n:()=>i});var a=s(5959),r=s(9863);let i=(0,a.v)()((0,r.Zr)(e=>({user:null,token:null,isAuthenticated:!1,login:function(t,s){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];a?(localStorage.setItem("token",s),sessionStorage.removeItem("token")):(sessionStorage.setItem("token",s),localStorage.removeItem("token")),localStorage.setItem("user",JSON.stringify(t)),e({user:t,token:s,isAuthenticated:!0})},logout:()=>{localStorage.removeItem("token"),sessionStorage.removeItem("token"),localStorage.removeItem("user"),e({user:null,token:null,isAuthenticated:!1})},updateUser:t=>{localStorage.setItem("user",JSON.stringify(t)),e({user:t})}}),{name:"auth-storage"}))},4392:(e,t,s)=>{"use strict";s.d(t,{P:()=>r});var a=s(7621);let r={createAppointment:async e=>(await a.A.post("/appointments",e)).data,getTodayQueue:async e=>(await a.A.get("/appointments/today",{params:{doctorId:e}})).data,updateAppointment:async(e,t)=>(await a.A.put("/appointments/".concat(e),t)).data}},4997:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(5155),r=s(2115),i=s(3304),l=s(4392),n=s(2544),o=s(6942),d=s(3611),c=s(7621);let m={createPrescription:async e=>(await c.A.post("/prescriptions",e)).data};var u=s(2663);let x=d.Ikc({name:d.YjP().min(1,"Medicine name is required"),type:d.k5n(["tablet","capsule","syrup","injection","ointment","drops","other"]),dosage:d.YjP().min(1,"Dosage is required (e.g. 1+0+1)"),timing:d.k5n(["before_meal","after_meal","with_meal","empty_stomach","as_needed"]),duration:d.YjP().min(1,"Duration is required"),instructions:d.YjP().optional()}),p=d.Ikc({chiefComplaints:d.YOg(d.YjP()).optional(),diagnosis:d.YjP().min(1,"Diagnosis is required"),medicines:d.YOg(x).min(1,"At least one medicine is required"),advice:d.YjP().optional(),investigations:d.YjP().optional(),notes:d.YjP().optional(),followUpDate:d.YjP().optional()});function g(e){let{patient:t,appointmentId:s,onSuccess:i,onCancel:l}=e,[d,c]=(0,r.useState)(!1),{register:x,control:g,handleSubmit:h,formState:{errors:b}}=(0,n.mN)({resolver:(0,o.u)(p),defaultValues:{chiefComplaints:[],diagnosis:"",medicines:[{name:"",type:"tablet",dosage:"1+0+1",timing:"after_meal",duration:"7 days",instructions:""}],advice:"",investigations:"",notes:"",followUpDate:""}}),{fields:f,append:j,remove:v}=(0,n.jz)({control:g,name:"medicines"}),y=async e=>{c(!0);try{let a={appointmentId:s,patientId:t._id,diagnosis:e.diagnosis,medicines:e.medicines,advice:e.advice,investigations:e.investigations?e.investigations.split(",").map(e=>e.trim()):[],chiefComplaints:e.chiefComplaints,notes:e.notes,followUp:e.followUpDate?{required:!0,date:e.followUpDate}:void 0};await m.createPrescription(a),u.Ay.success("Prescription created successfully!"),i()}catch(e){var a,r;console.error(e),u.Ay.error((null==(r=e.response)||null==(a=r.data)?void 0:a.message)||"Failed to create prescription")}finally{c(!1)}};return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-4xl mx-auto border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"New Prescription"}),(0,a.jsxs)("p",{className:"text-gray-500 text-sm",children:["Patient: ",(0,a.jsx)("span",{className:"font-semibold text-gray-700",children:t.name})," (",t.age,"y / ",t.gender,")"]})]}),(0,a.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:h(y),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-gray-50 p-4 rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Diagnosis ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{...x("diagnosis"),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 border p-2",rows:3,placeholder:"e.g. Viral Fever, Hypertension"}),b.diagnosis&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:String(b.diagnosis.message)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Investigations (Comma separated)"}),(0,a.jsx)("textarea",{...x("investigations"),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 border p-2",rows:3,placeholder:"e.g. CBC, Lipid Profile, X-Ray Chest"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Medicines (Rx)"}),(0,a.jsx)("button",{type:"button",onClick:()=>j({name:"",type:"tablet",dosage:"1+0+1",timing:"after_meal",duration:"5 days",instructions:""}),className:"text-sm bg-blue-100 text-blue-700 px-3 py-1.5 rounded hover:bg-blue-200 font-medium",children:"+ Add Medicine"})]}),(0,a.jsx)("div",{className:"space-y-3",children:f.map((e,t)=>{var s,r;return(0,a.jsxs)("div",{className:"flex flex-wrap md:flex-nowrap gap-3 items-start border p-3 rounded-md bg-gray-50 relative group",children:[(0,a.jsxs)("div",{className:"w-full md:w-3/12",children:[(0,a.jsx)("input",{...x("medicines.".concat(t,".name")),placeholder:"Medicine Name",className:"w-full border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500 border p-2 text-sm"}),(null==(r=b.medicines)||null==(s=r[t])?void 0:s.name)&&(0,a.jsx)("span",{className:"text-red-500 text-xs",children:"Required"})]}),(0,a.jsx)("div",{className:"w-1/2 md:w-2/12",children:(0,a.jsxs)("select",{...x("medicines.".concat(t,".type")),className:"w-full border-gray-300 rounded border p-2 text-sm bg-white",children:[(0,a.jsx)("option",{value:"tablet",children:"Tablet"}),(0,a.jsx)("option",{value:"capsule",children:"Capsule"}),(0,a.jsx)("option",{value:"syrup",children:"Syrup"}),(0,a.jsx)("option",{value:"injection",children:"Injection"}),(0,a.jsx)("option",{value:"ointment",children:"Ointment"})]})}),(0,a.jsx)("div",{className:"w-1/2 md:w-2/12",children:(0,a.jsx)("input",{...x("medicines.".concat(t,".dosage")),placeholder:"1+0+1",className:"w-full border-gray-300 rounded border p-2 text-sm"})}),(0,a.jsx)("div",{className:"w-1/2 md:w-2/12",children:(0,a.jsx)("input",{...x("medicines.".concat(t,".duration")),placeholder:"Dur. (e.g 7d)",className:"w-full border-gray-300 rounded border p-2 text-sm"})}),(0,a.jsx)("div",{className:"w-1/2 md:w-2/12",children:(0,a.jsxs)("select",{...x("medicines.".concat(t,".timing")),className:"w-full border-gray-300 rounded border p-2 text-sm bg-white",children:[(0,a.jsx)("option",{value:"after_meal",children:"After Meal"}),(0,a.jsx)("option",{value:"before_meal",children:"Before Meal"}),(0,a.jsx)("option",{value:"with_meal",children:"With Meal"}),(0,a.jsx)("option",{value:"empty_stomach",children:"Empty Stomach"})]})}),(0,a.jsx)("button",{type:"button",onClick:()=>v(t),className:"text-red-500 hover:bg-red-50 p-2 rounded self-center",children:"\uD83D\uDDD1"})]},e.id)})}),b.medicines&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-2",children:b.medicines.message})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Advice / Instructions"}),(0,a.jsx)("textarea",{...x("advice"),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 border p-2",rows:3,placeholder:"e.g. Drink plenty of water, Avoid oily food..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Follow Up Date (Optional)"}),(0,a.jsx)("input",{type:"date",...x("followUpDate"),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 border p-2"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t mt-4",children:[(0,a.jsx)("button",{type:"button",onClick:l,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 font-medium",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 font-medium disabled:bg-gray-400",children:d?"Saving...":"Save & Print Prescription"})]})]})]})}var h=s(9829);function b(){var e,t,s,n;let{user:o}=(0,i.n)(),[d,c]=(0,r.useState)([]),[m,x]=(0,r.useState)(null),[p,b]=(0,r.useState)(!1),[f,j]=(0,r.useState)(0);(0,r.useEffect)(()=>{(async()=>{if(null==o?void 0:o.id)try{let e=await l.P.getTodayQueue(o.id);c(e.data)}catch(e){console.error("Failed to fetch queue")}})()},[o,f]),(0,r.useEffect)(()=>{if(!(null==o?void 0:o.id))return;let e=(0,h.io)("http://localhost:5000");return e.on("connect",()=>{e.emit("join-doctor-room",o.id)}),e.on("queue-update",()=>{j(e=>e+1)}),()=>{e.disconnect()}},[o]);let v=async e=>{try{await l.P.updateAppointment(e._id,{status:"in_progress"}),x(e),b(!1),j(e=>e+1)}catch(e){u.Ay.error("Failed to start consultation")}},y=d.find(e=>"in_progress"===e.status),N=d.filter(e=>"waiting"===e.status);return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"mb-8 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Doctor Dashboard"}),(0,a.jsxs)("p",{className:"text-gray-500",children:["Welcome, Dr. ",null==o?void 0:o.name]})]}),(0,a.jsxs)("div",{className:"bg-white px-4 py-2 rounded-lg shadow border text-center",children:[(0,a.jsx)("span",{className:"block text-2xl font-bold text-blue-600",children:N.length}),(0,a.jsx)("span",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Waiting"})]})]}),m||y?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100 min-h-[600px] flex flex-col",children:[(0,a.jsxs)("div",{className:"bg-blue-600 text-white p-6 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold",children:["Currently Treating: ",null==(e=(m||y).patientId)?void 0:e.name]}),(0,a.jsxs)("p",{className:"text-blue-100 text-sm",children:[null==(t=(m||y).patientId)?void 0:t.age," Years • ",null==(s=(m||y).patientId)?void 0:s.gender," • ID: ",null==(n=(m||y).patientId)?void 0:n.patientId]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[!p&&(0,a.jsx)("button",{onClick:()=>b(!0),className:"bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold shadow hover:bg-gray-100 transition",children:"✍ Write Prescription"}),(0,a.jsx)("button",{onClick:()=>{x(null)},className:"bg-blue-700 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-800",children:"Back to Queue"})]})]}),(0,a.jsx)("div",{className:"p-6 flex-1",children:p?(0,a.jsx)(g,{patient:(m||y).patientId,appointmentId:(m||y)._id,onSuccess:()=>{b(!1),x(null),j(e=>e+1),u.Ay.success("Consultation completed.")},onCancel:()=>b(!1)}):(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("div",{className:"inline-block p-6 rounded-full bg-blue-50 mb-4",children:(0,a.jsx)("span",{className:"text-4xl",children:"\uD83E\uDE7A"})}),(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-800 mb-2",children:"Consultation in Progress"}),(0,a.jsxs)("p",{className:"text-gray-500 max-w-md mx-auto",children:["Review patient details, history, or click ",(0,a.jsx)("b",{children:'"Write Prescription"'})," to begin documentation."]})]})})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-100 overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50",children:(0,a.jsx)("h3",{className:"font-semibold text-gray-700",children:"Patient Queue"})}),0===N.length?(0,a.jsx)("div",{className:"p-12 text-center text-gray-500",children:"No patients waiting. Time for a coffee? ☕"}):(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:N.map(e=>{var t,s,r;return(0,a.jsxs)("div",{className:"p-4 flex items-center justify-between hover:bg-blue-50 transition-colors group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 text-blue-700 font-bold text-sm",children:e.serialNumber}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:null==(t=e.patientId)?void 0:t.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[null==(s=e.patientId)?void 0:s.gender,", ",null==(r=e.patientId)?void 0:r.age,"y"]})]})]}),(0,a.jsx)("button",{onClick:()=>v(e),className:"opacity-0 group-hover:opacity-100 transition-opacity bg-blue-600 text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-blue-700",children:"Call Patient"})]},e._id)})})]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-600 to-indigo-700 rounded-lg shadow-lg p-6 text-white mb-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Queue Status"}),(0,a.jsxs)("div",{className:"flex justify-between items-end mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-3xl font-bold",children:d.filter(e=>"completed"===e.status).length}),(0,a.jsx)("p",{className:"text-purple-200 text-sm",children:"Completed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-3xl font-bold",children:d.length}),(0,a.jsx)("p",{className:"text-purple-200 text-sm",children:"Total Today"})]})]})]})})]})]})}},7621:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let a=s(5125).A.create({baseURL:"http://localhost:50001/api",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let t=localStorage.getItem("token")||sessionStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{if(e.response)switch(e.response.status){case 401:localStorage.removeItem("token"),sessionStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/auth/login";break;case 403:console.error("Access denied:",e.response.data);break;case 404:console.error("Resource not found");break;case 500:console.error("Server error:",e.response.data);break;default:console.error("API Error:",e.response.data)}else e.request?console.error("Network error - no response received"):console.error("Error:",e.message);return Promise.reject(e)});let r=a},9706:(e,t,s)=>{Promise.resolve().then(s.bind(s,4997))}},e=>{e.O(0,[663,125,342,173,441,493,358],()=>e(e.s=9706)),_N_E=e.O()}]);